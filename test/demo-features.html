<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JwListBox - New Features Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .demo-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .demo-section h2 {
            color: #333;
            border-bottom: 2px solid #007acc;
            padding-bottom: 10px;
        }
        
        .demo-controls {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .demo-controls button {
            background: #007acc;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .demo-controls button:hover {
            background: #005a9e;
        }
        
        .demo-controls label {
            display: inline-block;
            margin: 0 10px;
            font-weight: bold;
        }
        
        .listbox-container {
            border: 1px solid #ddd;
            border-radius: 4px;
            min-height: 300px;
            background: white;
        }
        
        .event-log {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        
        .event-entry {
            margin: 2px 0;
            padding: 2px 4px;
        }
        
        .event-click { background: #e3f2fd; }
        .event-dblclick { background: #fff3e0; }
        .event-select { background: #e8f5e8; }
        
        .status-display {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>JwListBox - New Features Demo</h1>
    <p>This demo showcases two new features:</p>
    <ul>
        <li><strong>Prevent Auto-Selection:</strong> Option to emit click events without changing selection</li>
        <li><strong>Programmatic Clicks:</strong> API methods to trigger clicks via code</li>
    </ul>

    <!-- Feature 1: Prevent Auto-Selection -->
    <div class="demo-section">
        <h2>Feature 1: Prevent Auto-Selection</h2>
        <p>When <code>preventAutoSelection</code> is enabled, clicks emit events but don't change the selection state.</p>
        
        <div class="demo-controls">
            <label>
                <input type="checkbox" id="preventAutoSelection"> Prevent Auto-Selection
            </label>
            <button onclick="clearSelection1()">Clear Selection</button>
            <button onclick="clearLog1()">Clear Log</button>
        </div>
        
        <div class="status-display">
            Selected: <span id="selection1">[]</span>
        </div>
        
        <div class="listbox-container" id="listbox1"></div>
        
        <h3>Event Log:</h3>
        <div class="event-log" id="eventLog1"></div>
    </div>

    <!-- Feature 2: Programmatic Clicks -->
    <div class="demo-section">
        <h2>Feature 2: Programmatic Clicks</h2>
        <p>Use the API to trigger clicks programmatically. Try the buttons below:</p>
        
        <div class="demo-controls">
            <button onclick="programmaticClick('alice')">Click Alice</button>
            <button onclick="programmaticClick('bob')">Click Bob</button>
            <button onclick="programmaticClick('charlie')">Click Charlie</button>
            <button onclick="programmaticDblClick('alice')">Double-click Alice</button>
            <button onclick="programmaticCtrlClick('bob')">Ctrl+Click Bob</button>
            <button onclick="clearSelection2()">Clear Selection</button>
            <button onclick="clearLog2()">Clear Log</button>
        </div>
        
        <div class="status-display">
            Selected: <span id="selection2">[]</span>
        </div>
        
        <div class="listbox-container" id="listbox2"></div>
        
        <h3>Event Log:</h3>
        <div class="event-log" id="eventLog2"></div>
    </div>

    <!-- Load dependencies -->
    <script src="datamaster.js"></script>
    <script src="jw-listbox.js"></script>
    
    <script>
        // Sample data for both demos
        const sampleData = [
            { id: 'alice', name: 'Alice Johnson', department: 'Engineering', active: true },
            { id: 'bob', name: 'Bob Smith', department: 'Marketing', active: true },
            { id: 'charlie', name: 'Charlie Brown', department: 'Sales', active: false },
            { id: 'diana', name: 'Diana Prince', department: 'HR', active: true },
            { id: 'eve', name: 'Eve Adams', department: 'Finance', active: true }
        ];

        // Template for list display
        const listTemplate = `
            <div style="padding: 10px; border-bottom: 1px solid #eee;">
                <strong>{{name}}</strong> ({{id}})
                <br>
                <small style="color: #666;">{{department}} - {{active}}</small>
            </div>
        `;

        // Initialize first listbox (Prevent Auto-Selection demo)
        const listbox1 = new JwListBox('#listbox1', {
            idField: 'id',
            template: listTemplate,
            selectionMode: 'toggle'
        });

        listbox1.setSource(sampleData);

        // Event listeners for first listbox
        listbox1.on('click', (data) => {
            logEvent1('click', `Clicked: ${data.name} (${data.id})`);
            updateSelection1();
        });

        listbox1.on('dblclick', (data) => {
            logEvent1('dblclick', `Double-clicked: ${data.name} (${data.id})`);
        });

        listbox1.on('select', (data) => {
            logEvent1('select', `Selection changed`);
            updateSelection1();
        });

        // Initialize second listbox (Programmatic Clicks demo)
        const listbox2 = new JwListBox('#listbox2', {
            idField: 'id',
            template: listTemplate,
            selectionMode: 'toggle'
        });

        listbox2.setSource(sampleData);

        // Event listeners for second listbox
        listbox2.on('click', (data) => {
            logEvent2('click', `Clicked: ${data.name} (${data.id})`);
            updateSelection2();
        });

        listbox2.on('dblclick', (data) => {
            logEvent2('dblclick', `Double-clicked: ${data.name} (${data.id})`);
        });

        listbox2.on('select', (data) => {
            logEvent2('select', `Selection changed`);
            updateSelection2();
        });

        // Control functions for Feature 1
        function updateSelection1() {
            const selected = listbox1.getSelected();
            document.getElementById('selection1').textContent = JSON.stringify(selected);
        }

        function logEvent1(type, message) {
            const log = document.getElementById('eventLog1');
            const entry = document.createElement('div');
            entry.className = `event-entry event-${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${type.toUpperCase()}: ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function clearSelection1() {
            listbox1.clearSelection();
            updateSelection1();
        }

        function clearLog1() {
            document.getElementById('eventLog1').innerHTML = '';
        }

        // Control functions for Feature 2
        function updateSelection2() {
            const selected = listbox2.getSelected();
            document.getElementById('selection2').textContent = JSON.stringify(selected);
        }

        function logEvent2(type, message) {
            const log = document.getElementById('eventLog2');
            const entry = document.createElement('div');
            entry.className = `event-entry event-${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${type.toUpperCase()}: ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function programmaticClick(id) {
            listbox2.click(id);
        }

        function programmaticDblClick(id) {
            listbox2.dblclick(id);
        }

        function programmaticCtrlClick(id) {
            listbox2.click(id, { ctrlKey: true });
        }

        function clearSelection2() {
            listbox2.clearSelection();
            updateSelection2();
        }

        function clearLog2() {
            document.getElementById('eventLog2').innerHTML = '';
        }

        // Handle prevent auto-selection checkbox
        document.getElementById('preventAutoSelection').addEventListener('change', function(e) {
            listbox1.setPreventAutoSelection(e.target.checked);
            logEvent1('config', `Prevent auto-selection: ${e.target.checked}`);
        });

        // Initialize displays
        updateSelection1();
        updateSelection2();
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table Structure Debug</title>
    <style>
        body { margin: 20px; font-family: Arial, sans-serif; }
        .container { max-width: 800px; }
        .listbox-container { 
            height: 300px; 
            border: 1px solid #000; 
            position: relative; 
            margin: 10px 0; 
        }
        
        /* Basic table styling to see structure */
        table { 
            width: 100%; 
            border-collapse: collapse; 
        }
        th, td { 
            border: 1px solid #000; 
            padding: 5px; 
            text-align: left; 
        }
        th { 
            background-color: #f0f0f0; 
            font-weight: bold; 
        }
        .selected { 
            background-color: #cce7ff; 
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Table Structure Debug</h1>
        
        <h2>Expected Table Structure:</h2>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Department</th>
                    <th>Salary</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="4" style="font-weight: bold;">â–¼ Department: Engineering</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Alice Johnson</td>
                    <td>Engineering</td>
                    <td>85000</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Bob Smith</td>
                    <td>Engineering</td>
                    <td>75000</td>
                </tr>
            </tbody>
        </table>

        <h2>JwListBox Grid (with sections):</h2>
        <div class="listbox-container" id="listbox1"></div>
        
        <button onclick="inspectTable()">Inspect Table HTML</button>
        <button onclick="toggleHeaders()">Toggle Headers</button>
        
        <h2>Generated HTML:</h2>
        <pre id="htmlOutput" style="background: #f5f5f5; padding: 10px; font-size: 12px;"></pre>
    </div>

    <script src="datamaster.js"></script>
    <script src="jw-listbox.js"></script>
    
    <script>
        const testData = [
            { id: 1, name: 'Alice Johnson', department: 'Engineering', salary: 85000 },
            { id: 2, name: 'Bob Smith', department: 'Engineering', salary: 75000 },
            { id: 3, name: 'Carol Davis', department: 'Marketing', salary: 65000 },
            { id: 4, name: 'David Wilson', department: 'Marketing', salary: 55000 }
        ];

        let listbox1;

        function initializeDemo() {
            listbox1 = new JwListBox('#listbox1', {
                displayMode: 'grid',
                idField: 'id',
                showTableHeaders: true
            });

            listbox1.setSource(testData);
            listbox1.sort('department', false, true); // Sort with sections
            
            setTimeout(inspectTable, 100); // Auto-inspect after render
        }

        function inspectTable() {
            const container = document.getElementById('listbox1');
            const table = container.querySelector('table');
            
            if (table) {
                document.getElementById('htmlOutput').textContent = table.outerHTML;
                console.log('Table structure:', table);
                console.log('Table HTML:', table.outerHTML);
            } else {
                document.getElementById('htmlOutput').textContent = 'No table found!';
                console.log('Container HTML:', container.innerHTML);
            }
        }

        function toggleHeaders() {
            const currentSetting = listbox1._options.showTableHeaders;
            listbox1.setShowTableHeaders(!currentSetting);
            console.log('Headers toggled to:', !currentSetting);
            setTimeout(inspectTable, 100);
        }

        window.addEventListener('DOMContentLoaded', initializeDemo);
    </script>
</body>
</html>
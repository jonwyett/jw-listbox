<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JwListBox Sprint 9: Section Headers & Grouping Demo</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-style: italic;
        }
        .demo-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fafafa;
        }
        .demo-section h2 {
            margin-top: 0;
            color: #444;
            border-bottom: 2px solid #007acc;
            padding-bottom: 10px;
        }
        .controls {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        .control-group {
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .control-group label {
            font-weight: bold;
            min-width: 120px;
        }
        button {
            background-color: #007acc;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 2px;
        }
        button:hover {
            background-color: #005a99;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        select {
            padding: 5px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        input[type="checkbox"] {
            transform: scale(1.2);
        }
        .listbox-container {
            height: 400px;
            border: 2px solid #ddd;
            border-radius: 5px;
            position: relative;
            background-color: white;
        }
        .log {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            max-height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 5px;
            border-radius: 3px;
        }
        .log-entry.event {
            background-color: #d4edda;
            border-left: 3px solid #28a745;
        }
        .log-entry.info {
            background-color: #d1ecf1;
            border-left: 3px solid #17a2b8;
        }
        .note {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>JwListBox Sprint 9 Demo</h1>
        <p class="subtitle">Section Headers & Grouping Functionality</p>

        <div class="demo-section">
            <h2>Employee List with Department Sections</h2>
            <div class="note">
                <strong>Sprint 9 Features:</strong>
                <ul>
                    <li><strong>Section Headers:</strong> Data is grouped by department with collapsible headers</li>
                    <li><strong>Section Toggling:</strong> Click section headers to expand/collapse sections</li>
                    <li><strong>Auto Section Hide:</strong> Automatically toggle sections when enabled</li>
                    <li><strong>Programmatic Control:</strong> Use displaySection() method to control sections</li>
                    <li><strong>Events:</strong> Listen for 'click-section' events when headers are clicked</li>
                </ul>
            </div>

            <div class="controls">
                <div class="control-group">
                    <label for="displayMode">Display Mode:</label>
                    <select id="displayMode">
                        <option value="list">List Mode</option>
                        <option value="grid" selected>Grid Mode</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="autoSectionHide">Auto Section Hide:</label>
                    <input type="checkbox" id="autoSectionHide">
                    <span>Enable automatic expand/collapse on header click</span>
                </div>
                
                <div class="control-group">
                    <label>Sort & Section:</label>
                    <button onclick="sortByDepartment()">Sort by Department (with sections)</button>
                    <button onclick="sortByName()">Sort by Name (no sections)</button>
                    <button onclick="sortBySalary()">Sort by Salary (with sections)</button>
                </div>
                
                <div class="control-group">
                    <label>Section Control:</label>
                    <button onclick="expandAll()">Expand All Sections</button>
                    <button onclick="collapseAll()">Collapse All Sections</button>
                    <button onclick="toggleEngineering()">Toggle Engineering</button>
                    <button onclick="toggleMarketing()">Toggle Marketing</button>
                </div>
            </div>

            <div class="listbox-container" id="listbox1"></div>
        </div>

        <div class="demo-section">
            <h2>Event Log</h2>
            <div class="log" id="eventLog"></div>
            <button onclick="clearLog()">Clear Log</button>
        </div>
    </div>

    <!-- Include DataMaster and JwListBox -->
    <script src="datamaster.js"></script>
    <script src="jw-listbox.js"></script>
    
    <script>
        // Sample employee data
        const employeeData = [
            { id: 1, name: 'Alice Johnson', department: 'Engineering', salary: 85000, position: 'Senior Developer', startDate: '2019-03-15' },
            { id: 2, name: 'Bob Smith', department: 'Engineering', salary: 75000, position: 'Developer', startDate: '2020-06-01' },
            { id: 3, name: 'Carol Davis', department: 'Marketing', salary: 65000, position: 'Marketing Manager', startDate: '2018-11-20' },
            { id: 4, name: 'David Wilson', department: 'Marketing', salary: 55000, position: 'Marketing Coordinator', startDate: '2021-01-10' },
            { id: 5, name: 'Eva Brown', department: 'Engineering', salary: 90000, position: 'Lead Developer', startDate: '2017-05-08' },
            { id: 6, name: 'Frank Miller', department: 'Sales', salary: 70000, position: 'Sales Manager', startDate: '2019-09-12' },
            { id: 7, name: 'Grace Lee', department: 'Sales', salary: 60000, position: 'Sales Representative', startDate: '2020-12-05' },
            { id: 8, name: 'Henry Taylor', department: 'Engineering', salary: 80000, position: 'Developer', startDate: '2020-02-28' },
            { id: 9, name: 'Iris Chen', department: 'Marketing', salary: 58000, position: 'Content Creator', startDate: '2021-07-15' },
            { id: 10, name: 'Jack Anderson', department: 'Sales', salary: 65000, position: 'Account Manager', startDate: '2019-12-01' }
        ];

        // Initialize the listbox
        let listbox1;
        
        // Track section states for toggle functionality
        const sectionStates = {
            'Engineering': true,  // Initially expanded
            'Marketing': true,    // Initially expanded  
            'Sales': true         // Initially expanded
        };

        function initializeDemo() {
            // Create listbox instance
            listbox1 = new JwListBox('#listbox1', {
                displayMode: 'grid',
                idField: 'id',
                clickToSelect: true,
                showTableHeaders: true,
                autoSectionHide: false
            });

            // Set up event listeners
            listbox1.on('click-section', (payload) => {
                // Update our state tracking when sections are clicked directly
                sectionStates[payload.sectionValue] = payload.isCollapsed; // Will be toggled by auto-hide
                logEvent('click-section', `Section "${payload.sectionValue}" clicked (currently ${payload.isCollapsed ? 'collapsed' : 'expanded'})`);
            });

            listbox1.on('select', (payload) => {
                logEvent('select', `Selected: ${payload.selectedIds.join(', ')} (${payload.selectionCount} items)`);
            });

            listbox1.on('headerClick', (payload) => {
                logEvent('headerClick', `Header "${payload.field}" clicked`);
            });

            listbox1.on('error', (payload) => {
                logEvent('error', `Error: ${payload.message}`);
            });

            // Set data and initial sort with sections
            listbox1.setSource(employeeData);
            sortByDepartment();

            // Set up UI controls
            document.getElementById('displayMode').addEventListener('change', (e) => {
                listbox1.setDisplayMode(e.target.value);
                logInfo(`Display mode changed to: ${e.target.value}`);
            });

            document.getElementById('autoSectionHide').addEventListener('change', (e) => {
                listbox1.setAutoSectionHide(e.target.checked);
                logInfo(`Auto section hide ${e.target.checked ? 'enabled' : 'disabled'}`);
            });

            logInfo('Demo initialized with section functionality');
        }

        // Sort functions
        function sortByDepartment() {
            listbox1.sort('department', false, true); // Sort by department with sections
            logInfo('Sorted by department with sections enabled');
        }

        function sortByName() {
            listbox1.sort('name', false, false); // Sort by name without sections
            logInfo('Sorted by name without sections');
        }

        function sortBySalary() {
            listbox1.sort('salary', true, true); // Sort by salary descending with sections
            logInfo('Sorted by salary (descending) with sections enabled');
        }

        // Section control functions
        function expandAll() {
            const departments = ['Engineering', 'Marketing', 'Sales'];
            departments.forEach(dept => {
                sectionStates[dept] = true;
                listbox1.displaySection(dept, true);
            });
            logInfo('Expanded all sections');
        }

        function collapseAll() {
            const departments = ['Engineering', 'Marketing', 'Sales'];
            departments.forEach(dept => {
                sectionStates[dept] = false;
                listbox1.displaySection(dept, false);
            });
            logInfo('Collapsed all sections');
        }

        function toggleEngineering() {
            // Toggle the current state
            sectionStates['Engineering'] = !sectionStates['Engineering'];
            listbox1.displaySection('Engineering', sectionStates['Engineering']);
            logInfo(`Toggled Engineering section to ${sectionStates['Engineering'] ? 'expanded' : 'collapsed'}`);
        }

        function toggleMarketing() {
            // Toggle the current state
            sectionStates['Marketing'] = !sectionStates['Marketing'];
            listbox1.displaySection('Marketing', sectionStates['Marketing']);
            logInfo(`Toggled Marketing section to ${sectionStates['Marketing'] ? 'expanded' : 'collapsed'}`);
        }

        // Logging functions
        function logEvent(eventType, message) {
            const logElement = document.getElementById('eventLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry event';
            entry.innerHTML = `<strong>[${new Date().toLocaleTimeString()}] ${eventType}:</strong> ${message}`;
            logElement.appendChild(entry);
            logElement.scrollTop = logElement.scrollHeight;
        }

        function logInfo(message) {
            const logElement = document.getElementById('eventLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry info';
            entry.innerHTML = `<strong>[${new Date().toLocaleTimeString()}] INFO:</strong> ${message}`;
            logElement.appendChild(entry);
            logElement.scrollTop = logElement.scrollHeight;
        }

        function clearLog() {
            document.getElementById('eventLog').innerHTML = '';
        }

        // Initialize when page loads
        window.addEventListener('DOMContentLoaded', initializeDemo);
    </script>
</body>
</html>